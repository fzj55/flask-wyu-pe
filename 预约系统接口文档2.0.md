# 部署注意

* public模块中的ip获取方式
* log.txt文件与excel文件夹的权限
* app使用生产环境配置
* 部署使用 gunicorn 不要uwsgi（uwsgi与flask- apscheduler有兼容问题）
* private删除add与check接口
* 检查定时任务订单人数检查时间



# 0.公共

## 0.1 登录验证

### 0.1.1 需要检查登录的路由

​    /order/*

​	/user/*

​	/admin/*

​	



### 0.1.2 未通过返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1001：用户未登录<br />1002：没有此用户 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



## 0.2 图片验证码接口

### 0.2.1 接口路由

​      /ImgVcode_port

### 0.2.2 请求方式

​      get

### 0.2.3 请求参数

​      无

### 0.2.4 返回值

​      response对象，一张图片，直接这样使用即可：

```html
<img src="http://127.0.0.1:5000/ImgVcode_port" alt="">
```



## 0.3 登录

### 0.3.1 接口路由

​     /login_port



### 0.3.2 请求方式 

​     post



### 0.3.3 请求参数

| 字段     | 说明   | 类型   | 备注 |
| -------- | ------ | ------ | ---- |
| name     | 用户名 | 字符串 |      |
| password | 密码   | 字符串 |      |
| code     | 验证码 | 字符串 |      |



### 0.3.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1101：图片验证码失效<br />1102：验证码错误<br />1103：用户名或密码错误 |
| data | 数据列表 | 列表   | 请求成功：，token值<br />请求失败：空列表                    |
| msg  | 信息     | 字符串 | 提示信息                                                     |

```json
{
	"code": 0,
	"data": {
		"token": "IjEi.Ym0bmA.14e3X-CMYiBPo_1Ixl_qb5HFzC8",
		"user_id": "1"
	},
	"msg": "成功"
}
```



## 0.4 检查是否登录

### 0.4.1 接口路由

​     /check_login_port



### 0.4.2 请求方式 

​     get



### 0.4.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |



### 0.4.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1001：没有登录<br />1002：没有此用户 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



## 0.5 获取使用说明

### 0.5.1 接口路由

​     /get_instruction_port



### 0.5.2 请求方式 

​     get



### 0.5.3 请求参数

​    无



### 0.5.4 返回值

​	word文档



# 1. 用户端

## 1.1 用户

### 1.1.1 登出

#### 1.1.1.1 接口路由

​     /user/logout_port



#### 1.1.1.2 请求方式 

​     get



#### 1.1.1.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |



#### 1.1.1.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1001：用户未登录<br />1002：没有此用户<br />1004：非法尝试 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



### 1.1.2 用户信息

#### 1.1.2.1 接口路由

​     /user/message_port



#### 1.1.2.2 请求方式 

​     get



#### 1.1.2.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |



#### 1.1.2.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1001：用户未登录<br />1002：没有此用户<br />1004：非法尝试 |
| data | 数据列表 | 列表   | 成功：字典列表<br />失败：空列表                             |
| msg  | 信息     | 字符串 | 提示信息                                                     |

data：每个元素为一个字典 

| 字段         | 说明         | 类型   | 备注                                       |
| ------------ | ------------ | ------ | ------------------------------------------ |
| authority_id | 权限id       | 字符串 | 0：普通用户<br />1：管理员<br />-1：黑名单 |
| id           | 用户id       | 字符串 |                                            |
| img          | 头像图片路径 | 字符串 |                                            |
| name         | 学号         | 字符串 |                                            |
| reset_time   | 重置时间     | 字符串 |                                            |

```json
{
	"code": 0,
	"data": {
		"authority_id": "0",
		"id": "1",
		"img": null,
		"name": "1",
		"reset_time": null
	},
	"msg": "成功"
}
```



### 1.1.3 查询所有场所的本周剩余预定次数

#### 1.1.3.1 接口路由

​     /user/residue_degree_port



#### 1.1.3.2 请求方式 

​     get



#### 1.1.3.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |



#### 1.1.3.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1001：用户未登录<br />1002：没有此用户<br />1004：非法尝试<br />2403：请选择大场所 |
| data | 数据列表 | 列表   | 成功：字典列表<br />失败：空列表                             |
| msg  | 信息     | 字符串 | 提示信息                                                     |

```json
{
	"code": 0,
	"data": [
		{
			"name": "羽毛球场",
			"times": 2
		},
		{
			"name": "游泳馆",
			"times": 2
		}
	],
	"msg": "成功"
}
```



### 1.1.4 授权码生成

#### 1.1.4.1 接口路由

​     /user/auth_code



#### 1.1.4.2 请求方式 

​     get



#### 1.1.4.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |



#### 1.1.4.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1001：用户未登录<br />1002：没有此用户<br />1004：非法尝试<br />1104：未到30秒无法刷新 |
| data | 数据列表 | 列表   | 成功：字符串<br />失败：空列表                               |
| msg  | 信息     | 字符串 | 提示信息                                                     |

```json
{
	"code": 0,
	"data": "bc3b9ac7-ab3a-4ab3-8b48-65d37069938a",
	"msg": "成功"
}
```



## 1.2 公告

### 1.2.1 查询公告接口

#### 1.2.1.1 接口路由

​    /notice/normal_port



#### 1.2.1.2 请求方式

​    get



#### 1.2.1.3 请求参数

| 字段 | 说明   | 类型   | 备注 |
| ---- | ------ | ------ | ---- |
| id   | 场所id | 字符串 |      |



#### 1.2.1.4 返回值

| 字段 | 说明     | 类型   | 备注                                                      |
| ---- | -------- | ------ | --------------------------------------------------------- |
| code | 状态码   | 数值   | 0：成功<br />1201：此场所没有发布公告<br />1000：缺少参数 |
| data | 数据列表 | 列表   | 请求成功：字典列表<br />请求失败：空列表                  |
| msg  | 信息     | 字符串 | 提示信息                                                  |

data：每个元素为一个字典 

| 字段        | 说明         | 类型   | 备注           |
| ----------- | ------------ | ------ | -------------- |
| content     | 内容         | 字符串 |                |
| id          | 公告id       | 字符串 |                |
| place_id    | 关联的场所id | 字符串 |                |
| create_time | 公告创建时间 | 字符串 | 格式：%Y-%m-%d |

```json
{
	"code": 0,
	"data": [
		{
			"content": "今晚新增1 2 3号场地（仅今晚）场地开放时长与 4 5 6一致，预约开放时间 14点—17点",
			"create_time": "2022-04-22",
			"id": "10a10905-ade7-4316-9913-de71c2c8580d",
			"place_id": "1",
			"title": "临时通知"
		},
		{
			"content": "4月22日的开始预约时间为12：00",
			"create_time": "2022-04-22",
			"id": "a7b99a9e-27b1-4641-a2c6-30f3c077834b",
			"place_id": "1",
			"title": "紧急通知"
		}
	],
	"msg": "成功"
}
```



### 1.2.2 查询紧急公告接口

#### 1.2.2.1 接口路由

​    /notice/urgent_port



#### 1.2.2.2 请求方式

​    get



#### 1.2.2.3 请求参数

无



#### 1.2.2.4 返回值

| 字段 | 说明     | 类型   | 备注                                                      |
| ---- | -------- | ------ | --------------------------------------------------------- |
| code | 状态码   | 数值   | 0：成功<br />1201：此场所没有发布公告<br />1000：缺少参数 |
| data | 数据列表 | 列表   | 请求成功：字典列表<br />请求失败：空列表                  |
| msg  | 信息     | 字符串 | 提示信息                                                  |

data：每个元素为一个字典 

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| content | 内容   | 字符串 |      |
| id      | 公告id | 字符串 |      |



## 1.3 场所

### 1.3.1 开放大场所接口 

#### 1.3.1.1 接口路由

​     /place/open_port  



#### 1.3.1.2 请求方式 

​     get



#### 1.3.1.3 请求参数

| 字段      | 说明               | 类型 | 备注                                                         |
| --------- | ------------------ | ---- | ------------------------------------------------------------ |
| open_time | 查询哪天的开放场所 | 数值 | 可选，<br />不传值时：获取的抽签时间是今天的抽签时间（用于首页抽签）<br />传值时（任意）：获取的抽签时间是昨天的抽签时间（用于补选页面） |



#### 1.3.1.4 返回值

| 字段 | 说明     | 类型   | 备注                                     |
| ---- | -------- | ------ | ---------------------------------------- |
| code | 状态码   | 数值   | 0：成功                                  |
| data | 数据列表 | 列表   | 请求成功：字典列表<br />请求失败：空列表 |
| msg  | 提示信息 | 字符串 | 提示信息                                 |

data：每个元素为一个字典  

| 字段            | 说明         | 类型   | 备注                                                         |
| --------------- | :----------- | :----- | :----------------------------------------------------------- |
| id              | id号         | 字符串 |                                                              |
| img             | 图片路径     | 字符串 | 没有返回NULL                                                 |
| is_open         | 是否开放     | 布尔值 | true：开放  false：不开放，此处一定为true                    |
| name            | 场所名称     | 字符串 |                                                              |
| max_book_num    | 最大预定数量 | 数值   | 当前时间不在抽签时间范围内时无此字段                         |
| parent_id       | 父场所id     | 字符串 | 没有父场所为-1，此处都为-1                                   |
| draw_start_time | 抽签开始时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S<br />返回最近一次可参与的抽签开始时间 |
| draw_end_time   | 抽签结束时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S<br />返回最近一次可参与的抽签开始时间 |

```json
{
	"code": 0,
	"data": [
		{
			"book_frequency": 2,
            "draw_start_time": "2022-06-08 11:12:00",
            "draw_start_time": "2022-06-08 12:12:00",
			"id": "1",
			"img": "/image/badminton.png",
			"is_open": true,
			"name": "羽毛球场",
			"parent_id": "-1"
		},
		{
			"book_frequency": 0,
            "draw_start_time": "2022-06-08 11:12:00",
            "draw_start_time": "2022-06-08 12:12:00",
			"id": "2",
			"img": "/image/swim.png",
			"is_open": true,
			"name": "游泳馆",
			"parent_id": "-1"
		}
	],
	"msg": "成功"
}
```



### 1.3.2 场所详情（补选）

#### 1.3.2.1 请求路由

​    /place/detail_port



#### 1.3.2.2 请求方式

​    get



#### 1.3.2.3 请求参数

| 字段     | 说明     | 类型   | 备注 |
| -------- | -------- | ------ | ---- |
| place_id | 大场所id | 字符串 |      |



#### 1.3.2.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功，没有子场所<br />1：成功，有子场所<br />1000：缺少参数<br />1004：非法尝试<br />1006：数据库错误<br />1409：没有权限进入 |
| data | 数据列表 | 列表   | 成功：字典<br />失败：空列表                                 |
| msg  | 信息     | 字符串 | 提示信息                                                     |

data：

| 字段     | 说明           | 类型     | 备注                                                         |
| -------- | -------------- | -------- | ------------------------------------------------------------ |
| detail   | 详情信息       | 字典列表 |                                                              |
| drawtime | 抽签时间表信息 | 字典     |                                                              |
| time     | 不重复时间     | 列表     | 每个元素为场所开放到结束使用时间字符串<br />格式：%Y-%m-%d %H:%M-%H:%M |

code=0或1时

drawtime

| 字段            | 说明         | 类型   | 备注                    |
| --------------- | ------------ | ------ | ----------------------- |
| draw_end_time   | 抽签结束时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| draw_start_time | 抽签开始时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| id              | 抽签时间表id | 字符串 |                         |
| place_id        | 关联场地的id | 字符串 |                         |



code=1时detail每个元素：

| 字段           | 说明                     | 类型     | 备注 |
| :------------- | ------------------------ | -------- | ---- |
| book_frequency | 最多可预定次数           | 数值     |      |
| id             | 场地id                   | 字符串   |      |
| img            | 场地图片路径             | 字符串   |      |
| is_open        | 是否开放                 | 布尔值   |      |
| name           | 场所名字                 | 字符串   |      |
| parent_id      | 场所的父场所id           | 字符串   |      |
| timetable      | 场所关联的时间表详情信息 | 字典列表 |      |

timetable

| 字段            | 说明               | 类型   | 备注                    |
| --------------- | ------------------ | ------ | ----------------------- |
| book_end_time   | 补选结束时间       | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_start_time | 补选开始时间       | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| can_book_num    | 一次可预定的人数   | 列表   | [1,2,...]               |
| drawtime_id     | 关联的抽签时间表id | 字符串 |                         |
| end_time        | 场所结束使用时间   | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| id              | 时间表id           | 字符串 |                         |
| place_id        | 关联的场所id       | 字符串 |                         |
| start_time      | 场所开始使用时间   | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| ticket_num      | 剩余票数           | 数值   |                         |



code=0时detail每个元素：

| 字段            | 说明               | 类型   | 备注                    |
| --------------- | ------------------ | ------ | ----------------------- |
| book_end_time   | 补选结束时间       | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_start_time | 补选开始时间       | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| can_book_num    | 一次可预定的人数   | 列表   | [1,2,...]               |
| drawtime_id     | 关联的抽签时间表id | 字符串 |                         |
| end_time        | 场所结束使用时间   | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| id              | 时间表id           | 字符串 |                         |
| place_id        | 关联的场所id       | 字符串 |                         |
| start_time      | 场所开始使用时间   | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| ticket_num      | 剩余票数           | 数值   |                         |

```json
{
	"code": 1,
	"data": {
		"detail": [
			{
				"book_frequency": 2,
				"id": "3",
				"img": null,
				"is_open": true,
				"name": "羽毛球1号场",
				"parent_id": "1",
				"timetable": [
					{
						"book_end_time": "2022-05-01 13:40:28",
						"book_start_time": "2022-05-01 11:40:28",
						"can_book_num": [
							1,
							2,
							3,
							4
						],
						"drawtime_id": "eb0a7edf-5df3-4bf1-a4e7-c70364f1d99b",
						"end_time": "2022-05-01 18:40:28",
						"id": "6",
						"place_id": "3",
						"start_time": "2022-05-01 15:40:28",
						"ticket_num": 0,
						"time": "2022-05-01 15:40-18:40"
					}
				]
			},
			{
				"book_frequency": 2,
				"id": "4",
				"img": null,
				"is_open": true,
				"name": "羽毛球2号场",
				"parent_id": "1",
				"timetable": [
					{
						"book_end_time": "2022-05-01 13:40:28",
						"book_start_time": "2022-05-01 11:40:28",
						"can_book_num": [
							1,
							2,
							3,
							4
						],
						"drawtime_id": "eb0a7edf-5df3-4bf1-a4e7-c70364f1d99b",
						"end_time": "2022-05-01 18:40:28",
						"id": "7",
						"place_id": "4",
						"start_time": "2022-05-01 15:40:28",
						"ticket_num": 0,
						"time": "2022-05-01 15:40-18:40"
					}
				]
			},
			{
				"book_frequency": 2,
				"id": "5",
				"img": null,
				"is_open": true,
				"name": "羽毛球3号场",
				"parent_id": "1",
				"timetable": [
					{
						"book_end_time": "2022-05-01 10:00:13",
						"book_start_time": "2022-05-01 09:00:11",
						"can_book_num": [
							1,
							2,
							3,
							4
						],
						"drawtime_id": "eb0a7edf-5df3-4bf1-a4e7-c70364f1d99b",
						"end_time": "2022-05-01 09:00:16",
						"id": "8",
						"place_id": "5",
						"start_time": "2022-05-01 09:00:15",
						"ticket_num": 4,
						"time": "2022-05-01 09:00-09:00"
					}
				]
			},
			{
				"book_frequency": 2,
				"id": "6",
				"img": null,
				"is_open": true,
				"name": "羽毛球4号场",
				"parent_id": "1",
				"timetable": []
			},
			{
				"book_frequency": 2,
				"id": "7",
				"img": null,
				"is_open": true,
				"name": "羽毛球5号场",
				"parent_id": "1",
				"timetable": []
			},
			{
				"book_frequency": 2,
				"id": "8",
				"img": null,
				"is_open": true,
				"name": "羽毛球6号场",
				"parent_id": "1",
				"timetable": []
			},
			{
				"book_frequency": 2,
				"id": "9",
				"img": null,
				"is_open": true,
				"name": "羽毛球7号场",
				"parent_id": "1",
				"timetable": []
			},
			{
				"book_frequency": 2,
				"id": "10",
				"img": null,
				"is_open": true,
				"name": "羽毛球8号场",
				"parent_id": "1",
				"timetable": []
			},
			{
				"book_frequency": 2,
				"id": "11",
				"img": null,
				"is_open": true,
				"name": "羽毛球9号场",
				"parent_id": "1",
				"timetable": []
			},
			{
				"book_frequency": 2,
				"id": "12",
				"img": null,
				"is_open": true,
				"name": "羽毛球10号场",
				"parent_id": "1",
				"timetable": []
			},
			{
				"book_frequency": 2,
				"id": "13",
				"img": null,
				"is_open": true,
				"name": "羽毛球11号场",
				"parent_id": "1",
				"timetable": []
			},
			{
				"book_frequency": 2,
				"id": "14",
				"img": null,
				"is_open": true,
				"name": "羽毛球12号场",
				"parent_id": "1",
				"timetable": []
			}
		],
		"drawtime": {
			"draw_end_time": "2022-05-01 09:02:00",
			"draw_start_time": "2022-05-01 08:58:00",
			"id": "eb0a7edf-5df3-4bf1-a4e7-c70364f1d99b",
			"place_id": "1"
		},
		"time": [
			"2022-05-01 09:00-09:00",
			"2022-05-01 15:40-18:40"
		]
	},
	"msg": "成功"
}
```



# 1.4 订单

需要登录验证

## 1.4.1 参与抽签接口

#### 1.4.1.1 接口路由

​    /order/joindraw_port



#### 1.4.1.2 请求方式

​     post



#### 1.4.1.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段     | 说明     | 类型   | 备注 |
| -------- | -------- | ------ | ---- |
| place_id | 场所d    | 字符串 |      |
| book_num | 购票数量 | 数值   |      |



#### 1.4.1.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 1000：缺少参数<br />1001：用户未登录<br />1002：没有此用户<br />1003：没有权限<br />1004：非法尝试<br />1006：数据库错误<br />1404：今天已经参加过抽签<br />1407：本周预约次数达到上限<br />1501：未到参与抽签时间 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



### 1.4.2 查询抽签订单接口

#### 1.4.2.1 接口路由

​    /order/draworder_port



#### 1.4.2.2 请求方式

​     get



#### 1.4.2.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |



#### 1.4.2.4 返回值

| 字段 | 说明     | 类型   | 备注                                            |
| ---- | -------- | ------ | ----------------------------------------------- |
| code | 状态码   | 数值   | 0：成功<br />1003：没有权限<br />1403：暂无订单 |
| data | 数据列表 | 列表   | 成功：字典列表<br />失败：空列表                |
| msg  | 信息     | 字符串 | 提示信息                                        |

data：每个元素为一个字典

| 字段        | 说明             | 类型   | 备注                    |
| ----------- | ---------------- | ------ | ----------------------- |
| create_time | 创建时间         | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| order_id    | 订单id           | 字符串 |                         |
| book_num    | 预约数量         | 数值   |                         |
| draw_time   | 关联的抽签时间表 | 字典   |                         |
| place       | 关联的地点       | 字典   |                         |

draw_time：字典

| 字段            | 说明         | 类型   | 备注                    |
| --------------- | ------------ | ------ | ----------------------- |
| draw_id         | 抽签时间表id |        |                         |
| draw_start_time | 抽签开始时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| draw_end_time   | 抽签结束时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_start_time | 补选开始时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_end_time   | 补选结束时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |

place：字典

| 字段     | 说明     | 类型   | 备注 |
| -------- | -------- | ------ | ---- |
| place_id | 场所id   | 字符串 |      |
| name     | 场所名字 | 字符串 |      |

```json
{
	"code": 0,
	"data": [
		{
			"book_num": 4,
			"create_time": "2022-05-01 09:15:14",
			"drawtime": {
				"draw_end_time": "2022-05-01 11:14:04",
				"draw_id": "4",
				"draw_start_time": "2022-05-01 09:14:00"
			},
			"order_id": "8",
			"place": {
				"name": "羽毛球4号场",
				"place_id": "1"
			},
			"timetable": {
				"book_end_time": "2022-05-01 09:14:24",
				"book_start_time": "2022-05-01 09:14:23",
				"end_time": "2022-05-01 09:14:25",
				"start_time": "2022-05-01 09:14:25",
				"timetable_id": "6"
			}
		}
	],
	"msg": "成功"
}
```



### 1.4.3 查询订单接口

#### 1.4.3.1 接口路由

​    /order/order_port



#### 1.4.3.2 请求方式

​     get



#### 1.4.3.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |



#### 1.4.3.4 返回值

| 字段 | 说明     | 类型   | 备注                                            |
| ---- | -------- | ------ | ----------------------------------------------- |
| code | 状态码   | 数值   | 0：成功<br />1003：没有权限<br />1403：暂无订单 |
| data | 数据列表 | 列表   | 成功：字典列表<br />失败：空列表                |
| msg  | 信息     | 字符串 | 提示信息                                        |

data：每个元素为一个字典

| 字段        | 说明             | 类型   | 备注                                    |
| ----------- | ---------------- | ------ | --------------------------------------- |
| create_time | 创建时间         | 字符串 | 格式：%Y-%m-%d %H:%M:%S                 |
| order_id    | 订单id           | 字符串 |                                         |
| book_num    | 预约数量         | 数值   |                                         |
| status      | 订单状态         | 数值   | 2：等待抽签<br />1：中签<br />0：没中签 |
| tiemtable   | 关联的时间表     | 字典   |                                         |
| draw_time   | 关联的抽签时间表 | 字典   |                                         |
| place       | 关联的地点       | 字典   |                                         |

tiemtable：字典

| 字段            | 说明         | 类型   | 备注                    |
| --------------- | ------------ | ------ | ----------------------- |
| tiemtable_id    | 时间表id     | 字符串 |                         |
| start_time      | 开始时间     | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| end_time        | 结束时间     | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_start_time | 开始补选时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_end_time   | 结束补选时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |

draw_time：字典

| 字段            | 说明         | 类型   | 备注                    |
| --------------- | ------------ | ------ | ----------------------- |
| draw_id         | 抽签时间表id |        |                         |
| draw_start_time | 抽签开始时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| draw_end_time   | 抽签结束时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_start_time | 补选开始时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_end_time   | 补选结束时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |

place：字典

| 字段     | 说明     | 类型   | 备注 |
| -------- | -------- | ------ | ---- |
| place_id | 场所id   | 字符串 |      |
| name     | 场所名字 | 字符串 |      |

```json
{
	"code": 0,
	"data": [
		{
			"book_num": 3,
			"create_time": "2022-05-01 08:58:25",
			"drawtabel": {
				"draw_end_time": "2022-05-01 09:02:00",
				"draw_id": "eb0a7edf-5df3-4bf1-a4e7-c70364f1d99b",
				"draw_start_time": "2022-05-01 08:58:00"
			},
			"order_id": "4",
			"place": {
				"name": "羽毛球3号场",
				"place_id": "1"
			},
			"timetable": {
				"book_end_time": "2022-05-01 09:00:13",
				"book_start_time": "2022-05-01 09:00:11",
				"end_time": "2022-05-01 09:00:16",
				"start_time": "2022-05-01 09:00:15",
				"timetable_id": "5"
			},
            "status":2
		},
		{
			"book_num": 1,
			"create_time": "2022-04-27 09:41:06",
			"drawtabel": {
				"draw_end_time": "2022-04-28 21:00:00",
				"draw_id": "3",
				"draw_start_time": "2022-04-28 08:00:00"
			},
			"order_id": "2",
			"place": {
				"name": "游泳馆",
				"place_id": "-1"
			},
			"timetable": {
				"book_end_time": "2022-04-29 19:12:58",
				"book_start_time": "2022-04-29 15:12:56",
				"end_time": "2022-04-29 23:13:01",
				"start_time": "2022-04-29 22:13:01",
				"timetable_id": "2"
			},
            "status":0
		}
	],
	"msg": "成功"
}
```



### 1.4.4 删除订单

#### 1.4.4.1 请求路由

​    /order/del_order_port



#### 1.4.4.2 请求方式

​    get



#### 1.4.4.3 请求参数

 请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |
| id      | 订单id | 字符串 |      |



#### 1.4.4.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1003：没有权限<br />1004：非法尝试<br />1006：数据库错误<br />1406：不能取消预定了<br />1408：不能取消抽签 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |





### 1.4.5 补选预定接口

#### 1.4.5.1 请求路由

​    /order/book_port



#### 1.4.5.2 请求方式

​    post



#### 1.4.5.3 请求参数

 请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段         | 说明     | 类型   | 备注 |
| ------------ | -------- | ------ | ---- |
| timetable_id | 时间表id | 字符串 |      |
| book_num     | 预定数量 | 数值   |      |



#### 1.4.5.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功，没有子场所<br />1000：缺少参数<br />1003：没有权限<br />1004：非法尝试<br />1006：数据库错误<br />1401：没有此时间表<br />1410：没有此订单<br />1411：没有权限补选 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



### 1.4.6 邀请好友接口

#### 1.4.6.1 请求路由

​    /order/inviteuser_port



#### 1.4.6.2 请求方式

​    post



#### 1.4.6.3 请求参数

 请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段          | 说明       | 类型   | 备注                 |
| ------------- | ---------- | ------ | -------------------- |
| order_id      | 订单id     | 字符串 |                      |
| auth_codelist | 授权码列表 | 列表   | 每个元素为一个授权码 |



#### 1.4.6.4 返回值

| 字段 | 说明     | 类型       | 备注                                                         |
| ---- | -------- | ---------- | ------------------------------------------------------------ |
| code | 状态码   | 数值       | 0：成功，没有子场所<br />1000：缺少参数<br />1003：没有权限<br />1004：非法尝试<br />1006：数据库错误<br />1401：没有此时间表<br />1410：没有此订单<br />1412：输入授权码个数不能大于订单预定人数<br />1413：部分用户的加入失败，无问题用户已经加入 |
| data | 数据列表 | 列表或字典 | 成功：空列表<br />1413：字典                                 |
| msg  | 信息     | 字符串     | 提示信息                                                     |

1413：字典

| 字段           | 说明                         | 类型 | 备注                     |
| -------------- | ---------------------------- | ---- | ------------------------ |
| authcode_error | 授权码有问题，过期或输入错误 | 列表 | 每个元素为出错的授权码   |
| already_book   | 这些用户今天已经预约过       | 列表 | 每个元素为出错用户的学号 |
| no_residue     | 这些用户本周预定次数达到上限 | 列表 | 每个元素为出错用户的学号 |



### 1.4.7 查询子订单

#### 1.4.7.1 请求路由

​    /order/search_childorder_port



#### 1.4.7.2 请求方式

​    get



#### 1.4.7.3 请求参数

 请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段     | 说明   | 类型   | 备注 |
| -------- | ------ | ------ | ---- |
| user_id  | 用户id | 字符串 |      |
| order_id | 订单id | 字符串 |      |



#### 1.4.7.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1003：没有权限<br />1004：非法尝试<br />1006：数据库错误<br />1410：没有此订单 |
| data | 数据列表 | 列表   | 成功：字典列表<br />1413：字典                               |
| msg  | 信息     | 字符串 | 提示信息                                                     |

data列表：每个元素为一个字典

| 字段            | 说明                       | 类型   | 备注 |
| --------------- | -------------------------- | ------ | ---- |
| childorder_id   | 子订单id                   | 字符串 |      |
| belong_username | 子订单关联的用户名（学号） | 字符串 |      |



### 1.4.8 删除子订单

#### 1.4.8.1 请求路由

​    /order/del_childorder_port



#### 1.4.8.2 请求方式

​    get



#### 1.4.8.3 请求参数

 请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段            | 说明     | 类型   | 备注 |
| --------------- | -------- | ------ | ---- |
| user_id         | 用户id   | 字符串 |      |
| parent_order_id | 父订单id | 字符串 |      |
| child_order_id  | 子订单id | 字符串 |      |



#### 1.4.8.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1003：没有权限<br />1004：非法尝试<br />1006：数据库错误<br />1406：不能预定了<br />1410：没有此订单 |
| data | 数据列表 | 列表   | 成功：空列表<br />1413：字典                                 |
| msg  | 信息     | 字符串 | 提示信息                                                     |





# 2.管理员端

## 2.1 时间表

### 2.1.1 添加时间表

#### 2.1.1.1 请求路由

​    /admin/timetable/insert_port



#### 2.1.1.2 请求方式

​    post



#### 2.1.1.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

```json
{
    place_ids:字符串列表
    start_time:时间字符串,
    end_time:时间字符串,
    ticket_num:数值，
    can_book_num:数值,
    is_follow_cycle:布尔值,
    drawtime_id:字符串
}
```

| 字段            | 说明                   | 备注                     |
| --------------- | ---------------------- | ------------------------ |
| place_ids       | 关联的场所id列表       |                          |
| start_time      | 开始使用时间           | 格式：'%Y-%m-%d %H:%M%S' |
| end_time        | 结束使用时间           | 格式：'%Y-%m-%d %H:%M%S' |
| ticket_num      | 票数                   |                          |
| can_book_num    | 一次可预定人数         |                          |
| is_follow_cycle | 是否跟随抽签时间表循环 |                          |
| drawtime_id     | 关联的抽签时间表id     |                          |



#### 2.1.1.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1001：用户未登录<br />1002：没有此用户<br />1003：没有权限<br />1005：路径错误<br />1006：数据库错误<br />2101：开始时间必须小于结束时间<br />2102：日期格式错误<br />2103：不能设置过去时间<br />2106：一次性可预订人数大于票数<br />2108：票数小于一个人一次能预定数量<br />2110：没有指定的抽签时间表<br />2113：开始使用时间必须比预定结束时间晚30分钟 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



### 2.1.2 查询时间表

#### 2.1.2.1 请求路由

​     /admin/timetable/select_port



#### 2.1.2.2 请求方式

​     get



#### 2.1.2.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段        | 说明             | 类型   | 备注                                                         |
| ----------- | ---------------- | ------ | ------------------------------------------------------------ |
| user_id     | 用户id           | 字符串 |                                                              |
| place_id    | 场所id           | 字符串 |                                                              |
| drawtime_id | 抽签时间表id     | 字符串 | 可选，用于筛选出指定抽签时间表下的场地开放时间表             |
| start_time  | 场所开始使用时间 | 字符串 | 可选，用于筛选时间范围                                       |
| end_time    | 场所结束使用时间 | 字符串 | 可选，用于筛选时间范围                                       |
| base        | 根据哪个时间排序 | 字符串 | 可选值：start_time、end_time、name（无子场所时不能选此值）等字段 |
| sort_order  | 排序方式         | 字符串 | 可选值：asc（升序）、desc（降序）                            |



#### 2.1.2.4 返回值

| 字段 | 说明     | 类型   | 备注                             |
| ---- | -------- | ------ | -------------------------------- |
| code | 状态码   | 数值   | 0：成功<br />1403：暂无订单      |
| data | 数据列表 | 列表   | 成功：字典列表<br />失败：空列表 |
| msg  | 信息     | 字符串 | 提示信息                         |

data：每个元素为一个字典

| 字段               | 说明                     | 类型   | 备注                   |
| ------------------ | ------------------------ | ------ | ---------------------- |
| name               | 时间表所关联的场所的名字 | 字符串 | 无字场所是没有此字段   |
| end_time           | 结束时间                 | 字符串 | 格式：%Y-%m-%d %H:%M%S |
| id                 | 时间表id                 | 字符串 |                        |
| place_id           | 所属场地id               | 字符串 |                        |
| start_time         | 开始时间                 | 字符串 | 格式：%Y-%m-%d %H:%M%S |
| ticket_num         | 可预订数量               | 数值   |                        |
| initial_ticket_num | 初始化票数               | 数值   |                        |
| can_book_num       | 一次可预订票数           | 数值   |                        |
| is_follow_cycle    | 是否跟随抽签时间表循环   | 布尔值 |                        |
| drawtime_id        | 关联的抽签时间表id       | 字符串 |                        |

```json
{
	"code": 0,
	"data": [
		{
			"can_book_num": 4,
			"drawtime_id": "f5fc7129-a604-45c7-a6d5-5c017c7ad5f6",
			"end_time": "2022-05-04 10:48:00",
			"id": "6a4eb6b2-3db8-430f-a933-fe22590b2e7d",
			"initial_ticket_num": 4,
			"is_follow_cycle": true,
			"name": "羽毛球1号场",
			"place_id": "3",
			"start_time": "2022-05-04 10:47:00",
			"ticket_num": 4
		},
	],
	"msg": "成功"
}
```



### 2.1.3 修改时间表

#### 2.1.3.1 请求路由

​    /admin/timetable/update_port



#### 2.1.3.2 请求方式

​     post



#### 2.1.3.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段               | 说明                   | 类型   | 备注                    |
| ------------------ | ---------------------- | ------ | ----------------------- |
| id                 | 时间表id               | 字符串 |                         |
| place_id           | 关联场所id             | 字符串 |                         |
| can_book_num       | 一次可预定次数         | 数值   |                         |
| end_time           | 结束时间               | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| start_time         | 开始时间               | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| ticket_num         | 可预定数量             | 数值   |                         |
| is_follow_cycle    | 是否跟随抽签时间表循环 | 布尔值 |                         |
| initial_ticket_num | 初始化票数             | 数值   |                         |



#### 2.1.3.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1003：没有权限<br />1004：非法尝试<br />1005：路径错误<br />1006：数据库错误<br />2101：开始时间必须小于结束时间<br />2102：日期格式错误<br />2103：不能设置过去时间<br />2106：票数或初始票数小于一个人一次能预定数量<br />2110：没有指定的抽签时间表<br />2113：开始使用时间必须比预定结束时间晚30分钟<br />2411：场地已经开始使用不能修改时间 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



### 2.1.4 删除时间表

#### 2.1.4.1 请求路由

   /admin/timetable/delete_port



#### 2.1.4.2 请求方式

​    get



#### 2.1.4.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明     | 类型   | 备注 |
| ------- | -------- | ------ | ---- |
| user_id | 用户id   | 字符串 |      |
| id      | 时间表id | 字符串 |      |



#### 2.1.4.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1004：非法尝试<br />1006：数据库错误<br /> |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



### 2.1.5 制作时间表清单

#### 2.1.5.1 请求路由

   /admin/timetable/timetable_port



#### 2.1.5.2 请求方式

​    get



#### 2.1.5.3 请求参数

路径参数

| 字段     | 说明         | 类型   | 备注           |
| -------- | ------------ | ------ | -------------- |
| token    | 令牌         | 字符串 |                |
| user_id  | 用户id       | 字符串 |                |
| place_id | 场所id       | 字符串 |                |
| date     | 要打印哪天的 | 字符串 | 格式：%Y-%m-%d |



#### 2.1.5.4 返回值

​    excel文件



### 2.1.6 查询指定时间段下的订单

#### 2.1.6.1 请求路由

​     /admin/timetable/searchorder_port



#### 2.1.6.2 请求方式

​     get



#### 2.1.6.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段         | 说明     | 类型   | 备注 |
| ------------ | -------- | ------ | ---- |
| user_id      | 用户id   | 字符串 |      |
| timetabel_id | 时间表id | 字符串 |      |



#### 2.1.6.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1006：数据库错误<br />1401：没有此时间表 |
| data | 数据列表 | 列表   | 成功：字典列表<br />失败：空列表                             |
| msg  | 信息     | 字符串 | 提示信息                                                     |

data：每个元素为一个字典

| 字段        | 说明             | 类型   | 备注                                    |
| ----------- | ---------------- | ------ | --------------------------------------- |
| create_time | 创建时间         | 字符串 | 格式：%Y-%m-%d %H:%M:%S                 |
| order_id    | 订单id           | 字符串 |                                         |
| book_num    | 预约数量         | 数值   |                                         |
| status      | 订单状态         | 数值   | 2：等待抽签<br />1：中签<br />0：没中签 |
| tiemtable   | 关联的时间表     | 字典   |                                         |
| draw_time   | 关联的抽签时间表 | 字典   |                                         |
| place       | 关联的地点       | 字典   |                                         |
| user        | 关联的用户       | 字典   |                                         |

tiemtable：字典

| 字段            | 说明         | 类型   | 备注                    |
| --------------- | ------------ | ------ | ----------------------- |
| tiemtable_id    | 时间表id     | 字符串 |                         |
| start_time      | 开始时间     | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| end_time        | 结束时间     | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_start_time | 开始补选时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_end_time   | 结束补选时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |

draw_time：字典

| 字段            | 说明         | 类型   | 备注                    |
| --------------- | ------------ | ------ | ----------------------- |
| draw_id         | 抽签时间表id |        |                         |
| draw_start_time | 抽签开始时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| draw_end_time   | 抽签结束时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_start_time | 补选开始时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_end_time   | 补选结束时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |

place：字典

| 字段     | 说明     | 类型   | 备注 |
| -------- | -------- | ------ | ---- |
| place_id | 场所id   | 字符串 |      |
| name     | 场所名字 | 字符串 |      |

user：字典 

| 字段         | 说明         | 类型   | 备注                                       |
| ------------ | ------------ | ------ | ------------------------------------------ |
| authority_id | 权限id       | 字符串 | 0：普通用户<br />1：管理员<br />-1：黑名单 |
| id           | 用户id       | 字符串 |                                            |
| img          | 头像图片路径 | 字符串 |                                            |
| name         | 学号         | 字符串 |                                            |
| reset_time   | 重置时间     | 字符串 |                                            |

```json
{
	"code": 0,
	"data": [
		{
			"book_num": 3,
			"create_time": "2022-05-01 08:58:25",
			"drawtabel": {
				"draw_end_time": "2022-05-01 09:02:00",
				"draw_id": "eb0a7edf-5df3-4bf1-a4e7-c70364f1d99b",
				"draw_start_time": "2022-05-01 08:58:00"
			},
			"order_id": "4",
			"place": {
				"name": "羽毛球3号场",
				"place_id": "1"
			},
			"timetable": {
				"book_end_time": "2022-05-01 09:00:13",
				"book_start_time": "2022-05-01 09:00:11",
				"end_time": "2022-05-01 09:00:16",
				"start_time": "2022-05-01 09:00:15",
				"timetable_id": "5"
			},
            "status":2,
            "user": {
                "authority_id": "0",
                "id": "1",
                "img": null,
                "name": "1",
                "reset_time": null
            },
		},
		{
			"book_num": 1,
			"create_time": "2022-04-27 09:41:06",
			"drawtabel": {
				"draw_end_time": "2022-04-28 21:00:00",
				"draw_id": "3",
				"draw_start_time": "2022-04-28 08:00:00"
			},
			"order_id": "2",
			"place": {
				"name": "游泳馆",
				"place_id": "-1"
			},
			"timetable": {
				"book_end_time": "2022-04-29 19:12:58",
				"book_start_time": "2022-04-29 15:12:56",
				"end_time": "2022-04-29 23:13:01",
				"start_time": "2022-04-29 22:13:01",
				"timetable_id": "2"
			},
            "status":0,
            "user": {
                "authority_id": "0",
                "id": "1",
                "img": null,
                "name": "1",
                "reset_time": null
            },
		}
	],
	"msg": "成功"
}
```



## 2.2 公告

### 2.2.1 发布公告

#### 2.2.1.1 请求路由

   /admin/notice/announce_port



#### 2.2.1.2 请求参数

   post



#### 2.2.1.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段      | 说明           | 类型   | 备注 |
| --------- | -------------- | ------ | ---- |
| place_id  | 关联的场地     | 字符串 |      |
| title     | 标题           | 字符串 |      |
| content   | 内容           | 字符串 |      |
| is_urgent | 是否为紧急公告 | 布尔值 |      |



#### 2.2.1.4 返回值

| 字段 | 说明     | 类型   | 备注                                              |
| ---- | -------- | ------ | ------------------------------------------------- |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1006：数据库错误 |
| data | 数据列表 | 列表   | 空列表                                            |
| msg  | 信息     | 字符串 | 提示信息                                          |



### 2.2.2 查询公告

#### 2.2.2.1 请求路由

   /admin/notice/search_port



#### 2.2.2.2 请求参数

   get



#### 2.2.2.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段     | 说明   | 类型   | 备注 |
| -------- | ------ | ------ | ---- |
| place_id | 场地id | 字符串 |      |



#### 2.2.2.4 返回值

| 字段 | 说明     | 类型   | 备注                                                      |
| ---- | -------- | ------ | --------------------------------------------------------- |
| code | 状态码   | 数值   | 0：成功<br />1201：此场所没有发布公告<br />1000：缺少参数 |
| data | 数据列表 | 列表   | 空列表                                                    |
| msg  | 信息     | 字符串 | 提示信息                                                  |

### 2.2.3 删除公告

#### 2.2.2.1 请求路由

   /admin/notice/del_port



#### 2.2.3.2 请求参数

   get



#### 2.2.3.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段      | 说明   | 类型   | 备注 |
| --------- | ------ | ------ | ---- |
| notice_id | 通知id | 字符串 |      |



#### 2.2.3.4 返回值

| 字段 | 说明     | 类型   | 备注                                              |
| ---- | -------- | ------ | ------------------------------------------------- |
| code | 状态码   | 数值   | 0：成功<br />2412：查无此公告<br />1000：缺少参数 |
| data | 数据列表 | 列表   | 空列表                                            |
| msg  | 信息     | 字符串 | 提示信息                                          |

## 2.3 用户

### 2.3.1 新增用户

#### 2.3.1.1 请求路由

   /admin/user/insert_port



#### 2.3.1.2 请求参数

   post



#### 2.3.1.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段         | 说明         | 类型   | 备注                                                        |
| ------------ | ------------ | ------ | ----------------------------------------------------------- |
| name         | 用户名       | 字符串 |                                                             |
| password     | 密码         | 字符串 |                                                             |
| img          | 头像路径     | 字符串 |                                                             |
| reset_time   | 重置时间     | 字符串 | 可选，当authority_id为-1时必填<br />格式：%Y-%m-%d %H:%M:%S |
| authority_id | 关联的权限id | 字符串 |                                                             |



#### 2.3.1.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1002：没有此用户<br />1003：没有权限<br />1005：路径错误<br />1006：数据库错误<br />2102：日期格式错误<br />2301：此权限没在数据库中<br />2302：用户已经存在<br />2303：此用户不在黑名单无需设置重置时间<br />2304：此用户在黑名单中请设置重置时间 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



### 2.3.2 查询用户

#### 2.3.2.1 请求路由

   /admin/user/select_port



#### 2.3.2.2 请求参数

   get



#### 2.3.2.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段       | 说明             | 类型   | 备注                    |
| ---------- | ---------------- | ------ | ----------------------- |
| user_id    | 用户id           | 字符串 |                         |
| base       | 根据哪个字段排序 | 字符串 | 可选                    |
| sort_order | 排序方式         | 字符串 | 可选，可选值：desc、asc |



#### 2.3.2.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1002：没有此用户<br />1003：没有权限<br />1005：路径错误<br />1006：数据库错误<br />2404：base选值错误<br />2405：sort_order选值错误 |
| data | 数据列表 | 列表   | 成功：字典列表<br />失败：空列表                             |
| msg  | 信息     | 字符串 | 提示信息                                                     |

```json
{
	"code": 0,
	"data": [
		{
			"authority_id": "0",
			"id": "000052f2-2e69-4291-8a8f-3635f99fa8e0",
			"img": null,
			"name": "3121000719",
			"reset_time": null
		},
	],
	"msg": "成功"
}
```



### 2.3.3 更新用户

#### 2.3.1.1 请求路由

   /admin/user/update_port



#### 2.3.1.2 请求参数

   post



#### 2.2.1.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段         | 说明         | 类型   | 备注                                                        |
| ------------ | ------------ | ------ | ----------------------------------------------------------- |
| id           | 用户id       | 字符串 |                                                             |
| name         | 用户名       | 字符串 |                                                             |
| password     | 密码         | 字符串 | 可选                                                        |
| img          | 头像路径     | 字符串 |                                                             |
| reset_time   | 重置时间     | 字符串 | 可选，当authority_id为-1时必填<br />格式：%Y-%m-%d %H:%M:%S |
| authority_id | 关联的权限id | 字符串 |                                                             |



#### 2.2.1.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1002：没有此用户<br />1003：没有权限<br />1005：路径错误<br />1006：数据库错误<br />2102：日期格式错误<br />2301：此权限没在数据库中<br />2302：用户已经存在<br />2303：此用户不在黑名单无需设置重置时间<br />2304：此用户在黑名单中请设置重置时间 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



### 2.3.4 删除用户

#### 2.3.4.1 请求路由

   /admin/user/delete_port



#### 2.3.4.2 请求参数

   get



#### 2.3.4.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明         | 类型   | 备注 |
| ------- | ------------ | ------ | ---- |
| user_id | 用户id       | 字符串 |      |
| id      | 要删除的删除 | 字符串 |      |



#### 2.3.4.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1002：没有此用户<br />1003：没有权限<br />1005：路径错误<br />1006：数据库错误 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



### 2.3.5 获取批量增加用户excel模板

#### 2.3.5.1 请求路由

   /admin/user/get_template_port



#### 2.3.5.2 请求参数

   get



#### 2.3.5.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |



#### 2.3.5.4 返回值

​    excel文件



### 2.3.7 批量添加用户

#### 2.3.7.1 请求路由

   /admin/user/batch_add_port



#### 2.3.7.2 请求参数

   post



#### 2.3.7.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段     | 说明      | 类型      | 备注 |
| -------- | --------- | --------- | ---- |
| template | excel文件 | excel文件 |      |



#### 2.3.7.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1002：没有此用户<br />1003：没有权限<br />1005：路径错误<br />1006：数据库错误<br />2305：文件类型错误<br />2306：批量新增用户时用户信息错误导致终止，具体看错误信息 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |





## 2.4 抽签时间表

### 2.4.1 添加抽签时间表

#### 2.4.1.1  请求路由

   /admin/drawtime/insert_port



#### 2.4.1.2 请求参数

   post



#### 2.4.1.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段            | 说明             | 类型   | 备注                                   |
| --------------- | ---------------- | ------ | -------------------------------------- |
| draw_start_time | 参与抽签开始时间 | 字符串 |                                        |
| draw_end_time   | 参与抽签结束时间 | 字符串 |                                        |
| book_start_time | 补选开始时间     | 字符串 |                                        |
| book_end_time   | 补选结束时间     | 字符串 |                                        |
| cycle_time      | 循环时间         | 列表   | 每个元素为0~6的字符，表示星期一~星期日 |
| place_id        | 关联场地id       | 字符串 |                                        |



#### 2.4.1.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1006：数据库错误<br />1301：没有指定场所<br />2101：开始时间必须小于结束时间<br />2102：日期格式错误<br />2103：不能设置过去时间<br />2401：一天只能有一次抽签<br />2402：抽签时间不能大于预约时间<br />2403：请选择大场所 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



### 2.4.2 查询抽签时间表

#### 2.4.2.1  请求路由

   /admin/drawtime/select_port



#### 2.4.2.2 请求参数

   get



#### 2.4.2.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段            | 说明             | 类型   | 备注                                                         |
| --------------- | ---------------- | ------ | ------------------------------------------------------------ |
| place_id        | 关联场地id       | 字符串 |                                                              |
| draw_start_time | 参与抽签开始时间 | 字符串 | 可选，用于筛选时间范围                                       |
| draw_end_time   | 参与抽签结束时间 | 字符串 | 可选，用于筛选时间范围                                       |
| book_start_time | 补选开始时间     | 字符串 | 可选，用于筛选时间范围                                       |
| book_end_time   | 补选结束时间     | 字符串 | 可选，用于筛选时间范围                                       |
| base            | 根据哪个时间排序 | 字符串 | 可选值：draw_start_time、draw_end_time、book_start_time、book_end_time等字段 |
| sort_order      | 排序方式         | 字符串 | 可选值：asc（升序）、desc（降序）                            |



#### 2.4.2.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1006：数据库错误<br />1301：没有指定场所<br />2101：开始时间必须小于结束时间<br />2102：日期格式错误<br />2103：不能设置过去时间<br />2401：一天只能有一次抽签<br />2402：抽签时间不能大于预约时间<br />2403：请选择大场所 |
| data | 数据列表 | 列表   | 成功：字典列表<br />失败：空列表                             |
| msg  | 信息     | 字符串 | 提示信息                                                     |

data每个元素为一个字典

| 字段            | 说明             | 类型   | 备注 |
| --------------- | ---------------- | ------ | ---- |
| book_end_time   | 补选结束时间     | 字符串 |      |
| book_start_time | 补选开始时间     | 字符串 |      |
| cycle_time      | 循环时间         | 字符串 |      |
| draw_end_time   | 参与抽签结束时间 | 字符串 |      |
| draw_start_time | 参与抽签开始时间 | 字符串 |      |
| id              | 抽签时间表id     | 字符串 |      |
| place           | 关联场所信息     | 字典   |      |

place

| 字段           | 说明           | 类型   | 备注 |
| -------------- | -------------- | ------ | ---- |
| book_frequency | 可预订次数上限 | 数值   |      |
| id             | 场所id         | 字符串 |      |
| img            | 场所图片       | 字符串 |      |
| is_open        | 是否开放       | 布尔值 |      |
| name           | 场所名         | 字符串 |      |
| parent_id      | 父场所id       | 字符串 |      |

```json
{
	"code": 0,
	"data": [
        {
		    "book_end_time": "2022-06-03 18:00:00",
			"book_start_time": "2022-06-03 11:00:00",
			"cycle_time": null,
			"draw_end_time": "2022-06-03 10:00:00",
			"draw_start_time": "2022-06-03 09:00:00",
			"id": "1",
			"plcae": {
				"book_frequency": 2,
				"id": "1",
				"img": "/image/badminton.png",
				"is_open": true,
				"name": "羽毛球场",
				"parent_id": "-1"
			}
        },
		...
	],
	"msg": "成功"
}
```



### 2.4.3 删除时间表

#### 2.4.3.1  请求路由

   /admin/drawtime/delete_port



#### 2.4.2.2 请求参数

   get



#### 2.4.3.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段        | 说明         | 类型   | 备注 |
| ----------- | ------------ | ------ | ---- |
| user_id     | 用户id       | 字符串 |      |
| drawtime_id | 抽签时间表id | 字符串 |      |



#### 2.4.3.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1003：没有权限<br />1005：路径错误<br />1006：数据库错误<br />2110：没有指定的抽签时间表 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



### 2.4.4 修改时间表

#### 2.4.4.1  请求路由

   /admin/drawtime/update_port



#### 2.4.4.2 请求参数

   post



#### 2.4.4.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段            | 说明             | 类型   | 备注                                   |
| --------------- | ---------------- | ------ | -------------------------------------- |
| id              | 时间表id         | 字符串 |                                        |
| draw_start_time | 参与抽签开始时间 | 字符串 |                                        |
| draw_end_time   | 参与抽签结束时间 | 字符串 |                                        |
| book_start_time | 补选开始时间     | 字符串 |                                        |
| book_end_time   | 补选结束时间     | 字符串 |                                        |
| cycle_time      | 循环时间         | 列表   | 每个元素为0~6的字符，表示星期一~星期日 |



#### 2.4.4.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1003：没有权限<br />1006：数据库错误<br />1301：没有指定场所<br />2101：开始时间必须小于结束时间<br />2102：日期格式错误<br />2103：不能设置过去时间<br />2110：没有指定的抽签时间表<br />2401：一天只能有一次抽签<br />2402：抽签时间不能大于预约时间<br />2406：抽签开始时间要比现在晚<br />2407：抽签结束时间必须比现在要晚至少1分钟<br />2408：预约开始时间要比现在晚<br />2409：预约结束时间要比现在晚<br />2410：抽签及预约时间已过，只能延长预约结束时间<br />2411：场所已经开始使用不能设置了 |
| data | 数据列表 | 列表   | 空列表                                                       |
| msg  | 信息     | 字符串 | 提示信息                                                     |



## 2.5 订单

### 2.5.1 查询订单

#### 2.5.1.1  请求路由

   /admin/order/select_port



#### 2.5.1.2 请求参数

   get



#### 2.5.1.3 请求参数

请求头

| 字段  | 说明 | 类型   | 备注 |
| ----- | ---- | ------ | ---- |
| token | 令牌 | 字符串 |      |

路径参数

| 字段    | 说明   | 类型   | 备注 |
| ------- | ------ | ------ | ---- |
| user_id | 用户id | 字符串 |      |

请求体

| 字段       | 说明             | 类型   | 备注                              |
| ---------- | ---------------- | ------ | --------------------------------- |
| base       | 根据哪个时间排序 | 字符串 | 可选值：create_time等字段         |
| sort_order | 排序方式         | 字符串 | 可选值：asc（升序）、desc（降序） |



#### 2.5.1.4 返回值

| 字段 | 说明     | 类型   | 备注                                                         |
| ---- | -------- | ------ | ------------------------------------------------------------ |
| code | 状态码   | 数值   | 0：成功<br />1000：缺少参数<br />1006：数据库错误<br />2102：日期格式错误<br />2404：base选值错误<br />2405：sort_order选值错误 |
| data | 数据列表 | 列表   | 成功：字典列表<br />失败：空列表                             |
| msg  | 信息     | 字符串 | 提示信息                                                     |

data：每个元素为一个字典

| 字段        | 说明             | 类型   | 备注                                    |
| ----------- | ---------------- | ------ | --------------------------------------- |
| create_time | 创建时间         | 字符串 | 格式：%Y-%m-%d %H:%M:%S                 |
| order_id    | 订单id           | 字符串 |                                         |
| book_num    | 预约数量         | 数值   |                                         |
| status      | 订单状态         | 数值   | 2：等待抽签<br />1：中签<br />0：没中签 |
| tiemtable   | 关联的时间表     | 字典   |                                         |
| draw_time   | 关联的抽签时间表 | 字典   |                                         |
| place       | 关联的地点       | 字典   |                                         |
| user        | 关联的用户       | 字典   |                                         |

tiemtable：字典

| 字段            | 说明         | 类型   | 备注                    |
| --------------- | ------------ | ------ | ----------------------- |
| tiemtable_id    | 时间表id     | 字符串 |                         |
| start_time      | 开始时间     | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| end_time        | 结束时间     | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_start_time | 开始补选时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_end_time   | 结束补选时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |

draw_time：字典

| 字段            | 说明         | 类型   | 备注                    |
| --------------- | ------------ | ------ | ----------------------- |
| draw_id         | 抽签时间表id |        |                         |
| draw_start_time | 抽签开始时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| draw_end_time   | 抽签结束时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_start_time | 补选开始时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |
| book_end_time   | 补选结束时间 | 字符串 | 格式：%Y-%m-%d %H:%M:%S |

place：字典

| 字段     | 说明     | 类型   | 备注 |
| -------- | -------- | ------ | ---- |
| place_id | 场所id   | 字符串 |      |
| name     | 场所名字 | 字符串 |      |

user：字典 

| 字段         | 说明         | 类型   | 备注                                       |
| ------------ | ------------ | ------ | ------------------------------------------ |
| authority_id | 权限id       | 字符串 | 0：普通用户<br />1：管理员<br />-1：黑名单 |
| id           | 用户id       | 字符串 |                                            |
| img          | 头像图片路径 | 字符串 |                                            |
| name         | 学号         | 字符串 |                                            |
| reset_time   | 重置时间     | 字符串 |                                            |

```json
{
	"code": 0,
	"data": [
		{
			"book_num": 3,
			"create_time": "2022-05-01 08:58:25",
			"drawtabel": {
				"draw_end_time": "2022-05-01 09:02:00",
				"draw_id": "eb0a7edf-5df3-4bf1-a4e7-c70364f1d99b",
				"draw_start_time": "2022-05-01 08:58:00"
			},
			"order_id": "4",
			"place": {
				"name": "羽毛球3号场",
				"place_id": "1"
			},
			"timetable": {
				"book_end_time": "2022-05-01 09:00:13",
				"book_start_time": "2022-05-01 09:00:11",
				"end_time": "2022-05-01 09:00:16",
				"start_time": "2022-05-01 09:00:15",
				"timetable_id": "5"
			},
            "status":2,
            "user": {
                "authority_id": "0",
                "id": "1",
                "img": null,
                "name": "1",
                "reset_time": null
            },
		},
		{
			"book_num": 1,
			"create_time": "2022-04-27 09:41:06",
			"drawtabel": {
				"draw_end_time": "2022-04-28 21:00:00",
				"draw_id": "3",
				"draw_start_time": "2022-04-28 08:00:00"
			},
			"order_id": "2",
			"place": {
				"name": "游泳馆",
				"place_id": "-1"
			},
			"timetable": {
				"book_end_time": "2022-04-29 19:12:58",
				"book_start_time": "2022-04-29 15:12:56",
				"end_time": "2022-04-29 23:13:01",
				"start_time": "2022-04-29 22:13:01",
				"timetable_id": "2"
			},
            "status":0,
            "user": {
                "authority_id": "0",
                "id": "1",
                "img": null,
                "name": "1",
                "reset_time": null
            },
		}
	],
	"msg": "成功"
}
```



# Code状态表

| 值   | 说明                                               |
| ---- | -------------------------------------------------- |
| 0    | 成功                                               |
| 1    | 成功                                               |
| 1000 | 缺少参数                                           |
| 1001 | 用户未登录                                         |
| 1002 | 没有此用户                                         |
| 1003 | 没有权限                                           |
| 1004 | 非法尝试                                           |
| 1005 | 路径错误                                           |
| 1006 | 数据库错误                                         |
| 1007 | 您被加入了黑名单                                   |
| 1101 | 图片二维码失效                                     |
| 1102 | 验证码错误                                         |
| 1103 | 用户名或密码错误                                   |
| 1104 | 未到30秒无法刷新                                   |
| 1201 | 此场所没有发布公告                                 |
| 1301 | 没有指定场所                                       |
| 1302 | 暂未开启预约，请移步公共栏查看                     |
| 1303 | 今天没有设置抽签时间                               |
| 1401 | 没有此时间表                                       |
| 1402 | 票数不足                                           |
| 1403 | 暂无订单                                           |
| 1404 | 今天已经参与过抽签                                 |
| 1405 | 不在预定时间范围内                                 |
| 1406 | 不能取消预定了                                     |
| 1407 | 预约达到上限                                       |
| 1408 | 不能取消抽签                                       |
| 1409 | 没有权限进入                                       |
| 1410 | 没有此订单                                         |
| 1411 | 今天已经预定过了                                   |
| 1412 | 输入授权码个数不能大于订单预定人数                 |
| 1413 | 部分用户加入失败，无问题用户已经加入               |
| 1501 | 未到参与抽签时间                                   |
| 2101 | 开始时间必须小于结束时间                           |
| 2102 | 日期格式错误                                       |
| 2103 | 不能设置过去时间                                   |
| 2104 | 部分场所添加的时间与原有的冲突                     |
| 2105 | 此场所没有设置时间                                 |
| 2106 | 票数或初始票数小于一个人一次能预定数量             |
| 2107 | 预定开始或结束时间不能大于场地开始使用时间         |
| 2109 | 抽签开始或结束时间不能大于预约开始时间             |
| 2110 | 没有指定的抽签时间表                               |
| 2111 | 无法根据base字段排序                               |
| 2112 | base字段或sort_order字段值错误                     |
| 2113 | 开始使用时间必须比预定结束时间晚30分钟             |
| 2301 | 此权限没在数据库中                                 |
| 2302 | 用户已经存在                                       |
| 2303 | 此用户不在黑名单无需设置重置时间                   |
| 2304 | 此用户在黑名单中请设置重置时间                     |
| 2305 | 文件类型错误                                       |
| 2306 | 批量新增用户时用户信息错误导致终止，具体看错误信息 |
| 2401 | 一天只能有一次抽签                                 |
| 2402 | 抽签时间不能大于预约时间                           |
| 2403 | 请选择大场所                                       |
| 2404 | base选值错误                                       |
| 2405 | sort_order选值错误                                 |
| 2406 | 抽签开始时间要比现在晚                             |
| 2407 | 抽签结束时间必须比现在要晚至少1分钟                |
| 2408 | 预约开始时间要比现在晚                             |
| 2409 | 预约结束时间要比现在晚                             |
| 2410 | 抽签及预约时间已过，只能延长预约结束时间           |
| 2411 | 场所已经开始使用不能设置了                         |
| 2412 | 查无此公告                                         |
| 2413 | 暂无紧急公告                                       |

